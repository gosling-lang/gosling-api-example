{"version":3,"sources":["gos-template.js","App.js","index.js"],"names":["getSpec","cids","title","width","height","theme","duration","initWidth","window","innerWidth","App","props","defaultKeyword","useState","searchKeyword","setSearchKeyword","naviKeyword","setNaviKeyword","setInnerWidth","undefined","metadata","setMetadata","putativeTargets","setPutativeTargets","setTheme","gosRef","useRef","onZoomPos","pos","current","includes","api","zoomTo","split","onExport","isPdf","exportPDF","exportPNG","useEffect","addEventListener","debounce","e","inspector","cid","fetch","then","response","ok","console","log","statusText","json","data","catch","error","warn","getTitle","meta","id","treats","name","cell_line__name","cell_type__name","join","newSpec","useMemo","padding","className","ref","spec","compiled","vConf","species__name","type","defaultValue","placeholder","onKeyDown","key","target","value","Array","from","keys","map","d","k","onClick","chr","href","filter","t","symbol","toUpperCase","slice","visual_coordinate","unique_id","tissue_type__name","disease_state__name","factor__name","link","rel","paper__reference","open","ReactDOM","render","component","document","getElementById"],"mappings":"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","file":"static/js/main.70786056.chunk.js","sourcesContent":["export const sampleColor = [\"#0072B2\", \"#D45E00\", \"#029F73\", \"#E79F00\", \"#CB7AA7\"];\n\nexport const getSpec = ({ cids, title, width = 2000, height = 500, theme = 'light' }) => {\n  return {\n    \"tracks\": [\n      {\n        \"data\": {\n          \"url\": \"https://resgen.io/api/v1/tileset_info/?d=UvVPeLHuRDiYA3qwFlm7xQ\",\n          \"type\": \"multivec\",\n          \"row\": \"sample\",\n          \"column\": \"position\",\n          \"value\": \"peak\",\n          \"categories\": [\"sample 1\", \"sample 2\", \"sample 3\", \"sample 4\"]\n        },\n        \"mark\": \"bar\",\n        \"x\": { \"field\": \"position\", \"type\": \"genomic\"},\n        \"y\": { \"field\": \"peak\", \"type\": \"quantitative\"},\n      }\n    ]\n  };\n  // \"#0072B2\", \"#D45E00\"\n  const plusColor = \"#878787\"; //\"#D34B6C\";\n  const minusColor = \"#878787\"; //\"#5688B9\";\n\n  const getSampleColor = (index) => {\n    return sampleColor[index % sampleColor.length];\n  };\n\n  const getBwLink = (cid) =>\n    `http://dc2.cistrome.org/genome_browser/bw/${cid}_treat.bw`;\n\n  const getSampleBar = (cid, title, index, isBrush = false) => {\n    return {\n      alignment: \"overlay\",\n      data: {\n        url: getBwLink(cid),\n        type: \"bigwig\",\n        column: \"position\",\n        value: \"peak\",\n        binSize: 8,\n      },\n      title,\n      tracks: isBrush\n        ? [\n            {},\n            {\n              mark: \"brush\",\n              x: { linkingId: \"detail\" },\n              color: { value: \"#D34B6C\" },\n              stroke: { value: \"red\" },\n              strokeWidth: { value: 2 },\n              opacity: { value: 0.6 },\n            },\n          ]\n        : [{}],\n      mark: \"bar\",\n      x: { field: \"start\", type: \"genomic\" },\n      xe: { field: \"end\", type: \"genomic\" },\n      y: { field: \"peak\", type: \"quantitative\", axis: 'right' },\n      color: { value: getSampleColor(index) },\n      stroke: { value: \"lightgray\" },\n      strokeWidth: { value: 0.5 },\n      style: { outline: \"gray\" },\n      // opacity: { value: 0.6 },\n      width,\n      height: 40,\n    };\n  };\n\n  // console.log(\n  //   cids,\n  //   cids.filter((cid) => +cid).map((cid) => getSampleBar(cid))\n  // );\n\n  return {\n    // title: \"Explore Cistrome Data Using Gosling.js\",\n    // subtitle: `Cistrome IDs: ${cids.join(\", \")}`,\n    theme,\n    spacing: 50,\n    views: [\n      {\n        xDomain: { chromosome: \"7\" },\n        linkingId: \"overview\",\n        tracks: [\n          // ...cids.filter(cid => +cid).map((cid, i) => getSampleBar(cid, i, true)),\n          {\n            id: \"overview\",\n            linkingId: \"overview\",\n            title: \"Ideogram\",\n            xDomain: { chromosome: \"7\" },\n            layout: \"linear\",\n            alignment: \"overlay\",\n            data: {\n              url:\n                \"https://raw.githubusercontent.com/sehilyi/gemini-datasets/master/data/UCSC.HG38.Human.CytoBandIdeogram.csv\",\n              type: \"csv\",\n              chromosomeField: \"Chromosome\",\n              genomicFields: [\"chromStart\", \"chromEnd\"],\n            },\n            tracks: [\n              {\n                mark: \"text\",\n                dataTransform: [\n                  {\n                    type: \"filter\",\n                    field: \"Stain\",\n                    oneOf: [\"acen\"],\n                    not: true,\n                  },\n                ],\n                text: { field: \"Name\", type: \"nominal\" },\n                color: {\n                  field: \"Stain\",\n                  type: \"nominal\",\n                  domain: [\n                    \"gneg\",\n                    \"gpos25\",\n                    \"gpos50\",\n                    \"gpos75\",\n                    \"gpos100\",\n                    \"gvar\",\n                  ],\n                  range: [\"black\", \"black\", \"black\", \"black\", \"white\", \"black\"],\n                },\n                visibility: [\n                  {\n                    operation: \"less-than\",\n                    measure: \"width\",\n                    threshold: \"|xe-x|\",\n                    transitionPadding: 10,\n                    target: \"mark\",\n                  },\n                ],\n                style: { textStrokeWidth: 0 },\n              },\n              {\n                mark: \"rect\",\n                dataTransform: [\n                  {\n                    type: \"filter\",\n                    field: \"Stain\",\n                    oneOf: [\"acen\"],\n                    not: true,\n                  },\n                ],\n                color: {\n                  field: \"Stain\",\n                  type: \"nominal\",\n                  domain: [\n                    \"gneg\",\n                    \"gpos25\",\n                    \"gpos50\",\n                    \"gpos75\",\n                    \"gpos100\",\n                    \"gvar\",\n                  ],\n                  range: [\n                    \"white\",\n                    \"#D9D9D9\",\n                    \"#979797\",\n                    \"#636363\",\n                    \"black\",\n                    \"#82A3D0\",\n                  ],\n                },\n              },\n              {\n                mark: \"triangleRight\",\n                dataTransform: [\n                  { type: \"filter\", field: \"Stain\", oneOf: [\"acen\"] },\n                  { type: \"filter\", field: \"Name\", include: \"q\" },\n                ],\n                color: { value: \"#E9413B\" },\n              },\n              {\n                mark: \"triangleLeft\",\n                dataTransform: [\n                  { type: \"filter\", field: \"Stain\", oneOf: [\"acen\"] },\n                  { type: \"filter\", field: \"Name\", include: \"p\" },\n                ],\n                color: { value: \"#E9413B\" }, // #B40101\n              },\n              {\n                mark: \"brush\",\n                x: { linkingId: \"detail\" },\n                color: { value: \"#D34B6C\" },\n                stroke: { value: \"red\" },\n                strokeWidth: { value: 2 },\n                opacity: { value: 0.6 },\n              },\n            ],\n            x: { field: \"chromStart\", type: \"genomic\" },\n            xe: { field: \"chromEnd\", type: \"genomic\" },\n            stroke: { value: \"gray\" },\n            strokeWidth: { value: 0.5 },\n            style: { outline: \"black\", outlineWidth: 1 },\n            size: { value: 25 },\n            width,\n            height: 45,\n          },\n        ],\n      },\n      {\n        xDomain: { chromosome: \"7\", interval: [27066839, 27266927] },\n        linkingId: \"detail\",\n        tracks: [\n          {\n            id: \"detail-view\",\n            alignment: \"overlay\",\n            title: \"hg38 | Genes\",\n            data: {\n              url:\n                \"https://server.gosling-lang.org/api/v1/tileset_info/?d=gene-annotation\",\n              type: \"beddb\",\n              genomicFields: [\n                { index: 1, name: \"start\" },\n                { index: 2, name: \"end\" },\n              ],\n              valueFields: [\n                { index: 5, name: \"strand\", type: \"nominal\" },\n                { index: 3, name: \"name\", type: \"nominal\" },\n              ],\n              exonIntervalFields: [\n                { index: 12, name: \"start\" },\n                { index: 13, name: \"end\" },\n              ],\n            },\n            tracks: [\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"+\"] },\n                ],\n                mark: \"triangleRight\",\n                x: { field: \"end\", type: \"genomic\" },\n                size: { value: 15 },\n              },\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                ],\n                mark: \"text\",\n                text: { field: \"name\", type: \"nominal\" },\n                x: { field: \"start\", type: \"genomic\" },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: { dy: -15, outline: \"black\", outlineWidth: 0 },\n              },\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"-\"] },\n                ],\n                mark: \"triangleLeft\",\n                x: { field: \"start\", type: \"genomic\" },\n                size: { value: 15 },\n                style: { align: \"right\", outline: \"black\", outlineWidth: 0 },\n              },\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"exon\"] },\n                ],\n                mark: \"rect\",\n                x: { field: \"start\", type: \"genomic\" },\n                size: { value: 15 },\n                xe: { field: \"end\", type: \"genomic\" },\n              },\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"+\"] },\n                ],\n                mark: \"rule\",\n                x: { field: \"start\", type: \"genomic\" },\n                strokeWidth: { value: 2 },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: {\n                  linePattern: { type: \"triangleRight\", size: 3.5 },\n                  outline: \"black\",\n                  outlineWidth: 0,\n                },\n              },\n              {\n                dataTransform: [\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"-\"] },\n                ],\n                mark: \"rule\",\n                x: { field: \"start\", type: \"genomic\" },\n                strokeWidth: { value: 2 },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: {\n                  linePattern: { type: \"triangleLeft\", size: 3.5 },\n                  outline: \"black\",\n                  outlineWidth: 0,\n                },\n              },\n            ],\n            row: { field: \"strand\", type: \"nominal\", domain: [\"+\", \"-\"] },\n            color: {\n              field: \"strand\",\n              type: \"nominal\",\n              domain: [\"+\", \"-\"],\n              range: [plusColor, minusColor],\n            },\n            visibility: [\n              {\n                operation: \"less-than\",\n                measure: \"width\",\n                threshold: \"|xe-x|\",\n                transitionPadding: 10,\n                target: \"mark\",\n              },\n            ],\n            opacity: { value: 0.8 },\n            style: { background: \"#F5F5F5\", outlineWidth: 0 },\n            width,\n            height: 100,\n          },\n          {\n            title: \"hg38 | GENECODE Transcript (Max. 15 Rows)\",\n            alignment: \"overlay\",\n            data: {\n              url:\n                \"https://server.gosling-lang.org/api/v1/tileset_info/?d=transcript-hg38-beddb\",\n              type: \"beddb\",\n              genomicFields: [\n                { index: 1, name: \"start\" },\n                { index: 2, name: \"end\" },\n              ],\n              valueFields: [\n                { index: 0, name: 'chr', type: 'nominal' },\n                { index: 5, name: \"strand\", type: \"nominal\" },\n                { index: 3, name: \"name\", type: \"nominal\" },\n                {\"index\": 9, \"name\": \"exon_start\", \"type\": \"nominal\"},\n                {\"index\": 10, \"name\": \"exon_end\", \"type\": \"nominal\"}\n              ],\n            },\n            dataTransform: [\n              {\n                type: \"displace\",\n                method: \"pile\",\n                boundingBox: { startField: \"start\", endField: \"end\" },\n                newField: \"row\",\n                maxRows: 15,\n              },\n              { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n            ],\n            tracks: [\n              {\n                dataTransform: [\n                  {\n                    type: \"displace\",\n                    method: \"pile\",\n                    boundingBox: { startField: \"start\", endField: \"end\" },\n                    newField: \"row\",\n                    maxRows: 15,\n                  },\n\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"+\"] },\n                ],\n                mark: \"triangleRight\",\n                x: { field: \"end\", type: \"genomic\" },\n                size: { value: 15 },\n              },\n              {\n                dataTransform: [\n                  {\n                    type: \"displace\",\n                    method: \"pile\",\n                    boundingBox: { startField: \"start\", endField: \"end\" },\n                    newField: \"row\",\n                    maxRows: 15,\n                  },\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                ],\n                mark: \"text\",\n                text: { field: \"name\", type: \"nominal\" },\n                x: { field: \"start\", type: \"genomic\" },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: { dy: -10, outline: \"black\", outlineWidth: 0 },\n              },\n              {\n                dataTransform: [\n                  {\n                    type: \"displace\",\n                    method: \"pile\",\n                    boundingBox: { startField: \"start\", endField: \"end\" },\n                    newField: \"row\",\n                    maxRows: 15,\n                  },\n\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"-\"] },\n                ],\n                mark: \"triangleLeft\",\n                x: { field: \"start\", type: \"genomic\" },\n                size: { value: 15 },\n                style: { align: \"right\", outline: \"black\", outlineWidth: 0 },\n              },\n              {\n                \"dataTransform\": [\n                  {\n                    \"type\": \"displace\",\n                    \"method\": \"pile\",\n                    \"boundingBox\": {\"startField\": \"start\", \"endField\": \"end\"},\n                    \"newField\": \"row\",\n                    \"maxRows\": 15\n                  },\n                  {\n                    \"type\": \"exonSplit\",\n                    \"separator\": \",\",\n                    \"flag\": {\"field\": \"type\", \"value\": \"exon\"},\n                    \"fields\": [\n                      {\n                        \"field\": \"exon_start\",\n                        \"type\": \"genomic\",\n                        \"newField\": \"start\",\n                        \"chrField\": \"chr\"\n                      },\n                      {\n                        \"field\": \"exon_end\",\n                        \"type\": \"genomic\",\n                        \"newField\": \"end\",\n                        \"chrField\": \"chr\"\n                      }\n                    ]\n                  },\n                  {\"type\": \"filter\", \"field\": \"type\", \"oneOf\": [\"exon\"]}\n                ],\n                \"mark\": \"rect\",\n                \"size\": {\"value\": 15},\n                \"x\": {\"field\": \"start\", \"type\": \"genomic\"},\n                \"xe\": {\"field\": \"end\", \"type\": \"genomic\"}\n              },\n              {\n                dataTransform: [\n                  {\n                    type: \"displace\",\n                    method: \"pile\",\n                    boundingBox: { startField: \"start\", endField: \"end\" },\n                    newField: \"row\",\n                    maxRows: 15,\n                  },\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"+\"] },\n                ],\n                mark: \"rule\",\n                x: { field: \"start\", type: \"genomic\" },\n                strokeWidth: { value: 2 },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: {\n                  linePattern: { type: \"triangleRight\", size: 3.5 },\n                  outline: \"black\",\n                  outlineWidth: 0,\n                },\n              },\n              {\n                dataTransform: [\n                  {\n                    type: \"displace\",\n                    method: \"pile\",\n                    boundingBox: { startField: \"start\", endField: \"end\" },\n                    newField: \"row\",\n                    maxRows: 15,\n                  },\n                  { type: \"filter\", field: \"type\", oneOf: [\"gene\"] },\n                  { type: \"filter\", field: \"strand\", oneOf: [\"-\"] },\n                ],\n                mark: \"rule\",\n                x: { field: \"start\", type: \"genomic\" },\n                strokeWidth: { value: 2 },\n                xe: { field: \"end\", type: \"genomic\" },\n                style: {\n                  linePattern: { type: \"triangleRight\", size: 3.5 },\n                  outline: \"black\",\n                  outlineWidth: 0,\n                },\n              },\n            ],\n            row: { field: \"row\", type: \"nominal\" },\n            color: {\n              field: \"strand\",\n              type: \"nominal\",\n              domain: [\"+\", \"-\"],\n              range: [plusColor, minusColor],\n            },\n            visibility: [\n              {\n                operation: \"less-than\",\n                measure: \"width\",\n                threshold: \"|xe-x|\",\n                transitionPadding: 10,\n                target: \"mark\",\n              },\n            ],\n            opacity: { value: 0.8 },\n            style: { outline: \"black\", outlineWidth: 0 },\n            width,\n            height,\n          },\n          ...cids.filter((cid) => +cid).map((cid, i) => getSampleBar(cid, title, i)),\n        ],\n      },\n    ],\n  };\n};\n","import { debounce } from \"lodash\";\nimport { GoslingComponent } from \"gosling.js\";\nimport { getSpec } from \"./gos-template\";\nimport \"./App.css\";\nimport { useEffect, useMemo, useRef, useState } from \"react\";\n\nconst padding = 20;\nconst duration = 1000;\nconst initWidth = window.innerWidth;\n\nfunction App(props) {\n  // url parameters\n  // const urlParams = qs.parse(props.location.search, { ignoreQueryPrefix: true });\n  // const cid = urlParams?.id; // Cistrome ID\n\n  const defaultKeyword = \"1\";\n  const [searchKeyword, setSearchKeyword] = useState(defaultKeyword);\n\n  const [naviKeyword, setNaviKeyword] = useState();\n\n  // visual parameters\n  const [innerWidth, setInnerWidth] = useState(initWidth);\n\n  // Metadata\n  const [metadata, setMetadata] = useState(undefined);\n\n  // Putative targets\n  const [putativeTargets, setPutativeTargets] = useState(undefined);\n\n  // Theme\n  const [theme, setTheme] = useState('light');\n\n  // API of gosling.js\n  const gosRef = useRef();\n\n  function onZoom(gene, pos) {\n    if (!gosRef?.current) return;\n\n    gosRef.current.api.zoomToGene(\"detail-view\", gene, duration);\n    gosRef.current.api.zoomTo(\"overview\", pos, duration);\n  }\n\n  function onZoomChr(chr) {\n    if (!gosRef?.current) return;\n\n    gosRef.current.api.zoomTo(\"detail-view\", chr, duration);\n    gosRef.current.api.zoomTo(\"overview\", chr, duration);\n  }\n\n  function onZoomPos(pos) {\n    if (!gosRef?.current) return;\n\n    if (!pos.includes(\"chr\") || !pos.includes(\":\") || !pos.includes(\"-\"))\n      return;\n\n    gosRef.current.api.zoomTo(\"overview\", pos.split(\":\")[0], duration);\n    gosRef.current.api.zoomTo(\"detail-view\", pos, duration);\n  }\n\n  function onExport(isPdf) {\n    if (!gosRef?.current) return;\n\n    if(isPdf) {\n      gosRef.current.api.exportPDF();\n    } else {\n      gosRef.current.api.exportPNG();\n    }\n  }\n\n  useEffect(() => {\n    window.addEventListener(\n      \"resize\",\n      debounce((e) => {\n        setInnerWidth(window.innerWidth);\n      }, 1000)\n    );\n\n    inspector(defaultKeyword);\n  }, []);\n\n  // validate the spec\n  // const validity = validateGoslingSpec(getSpec({cid}));\n  // if(validity.state === 'error') {\n  //     console.warn('Gosling spec is invalid!', validity.message);\n  //     return;\n  // }\n\n  // refer to https://github.com/hms-dbmi/cistrome-explorer/blob/b12238aeadbaf4a41f5445c32dbe3d6518d6fd1d/src/demo/CistromeToolkit.js#L128\n  const inspector = (cid) => {\n    fetch(`http://dc2.cistrome.org/api/inspector?id=${cid}`)\n      .then((response) => {\n        if (!response.ok) {\n          console.log(`Error: ${response.statusText}`);\n        }\n        return response.json();\n      })\n      .then((data) => {\n        // console.log(data);\n        setMetadata(data);\n      })\n      .catch((error) => {\n        console.warn(error);\n      });\n  };\n\n  const fetchPutativeTargets = (cid) => {\n    fetch(`http://dc2.cistrome.org/api/putative_target_ng?gene=&id=${cid}`)\n      .then((response) => {\n        if (!response.ok) {\n          console.log(`Error: ${response.statusText}`);\n        }\n        return response.json();\n      })\n      .then((data) => {\n        // console.log('putativeTargets', data);\n        setPutativeTargets(data);\n      })\n      .catch((error) => {\n        console.warn(error);\n      });\n  };\n\n  useEffect(() => {\n    // const cids = searchKeyword.split(\",\");\n    if (+searchKeyword) {\n      inspector(searchKeyword);\n      fetchPutativeTargets(searchKeyword);\n    }\n  }, [searchKeyword]);\n\n  useEffect(() => {\n    if (!naviKeyword) return;\n\n    // if(naviKeyword.includes('chr')) {\n    onZoomPos(naviKeyword);\n    // } else {\n    // onZoom(naviKeyword);\n    // }\n  }, [naviKeyword]);\n\n  const getTitle = (meta) => {\n    return [\n      meta?.id,\n      meta?.treats[0]?.name,\n      meta?.treats[0]?.cell_line__name,\n      meta?.treats[0]?.cell_type__name,\n    ].join(\" | \");\n  };\n\n  const newSpec = useMemo(() => {\n    console.log('metadata', metadata);\n    return getSpec({\n      theme,\n      cids: [metadata?.id],\n      title: [getTitle(metadata)],\n      width:\n        innerWidth -\n        padding * 2 /* padding */ -\n        400 /* gene panel on the left */ -\n        400 /* metadata panel on the right*/,\n    });\n  }, [theme, metadata, innerWidth]);\n\n  return (\n    <>\n      <div className={`vis ${theme}`}>\n        <GoslingComponent\n          ref={gosRef}\n          spec={newSpec}\n          padding={padding}\n          compiled={(spec, vConf) => {\n            /* Callback function when compiled */\n          }}\n        />\n      </div>\n      <div\n        className={\n          metadata?.treats?.[0]?.species__name === \"Mus musculus\"\n            ? \"vis-overlay\"\n            : \"vis-overlay-hidden\"\n        }\n      >\n        {\"Mouse Genome Is Not Supported Yet\"}\n      </div>\n      <div className={`gene-list ${theme}`}>\n        <h5>Cistrome ID</h5>\n        <input\n          // ref={searchBoxRef}\n          className={\"search-box\"}\n          type=\"text\"\n          defaultValue={defaultKeyword}\n          name=\"default name\"\n          placeholder={`Cistrome ID (e.g., ${defaultKeyword})`}\n          // onChange={debounce((e) => {\n          //   setSearchKeyword(e.target.value);\n          // }, 1000)}\n          onKeyDown={(e) => {\n            switch (e.key) {\n              case \"ArrowUp\":\n                break;\n              case \"ArrowDown\":\n                break;\n              case \"Enter\":\n                setSearchKeyword(e.target.value);\n                // setGeneSuggestions([]);\n                // if(searchKeyword.includes('chr')) {\n                //     hmRef.current.api.zoomTo(searchKeyword);\n                // } else {\n                //     hmRef.current.api.zoomToGene(searchKeyword);\n                // }\n                break;\n              case \"Esc\":\n              case \"Escape\":\n                break;\n            }\n          }}\n        />\n        <h5>Navigation</h5>\n        <input\n          // ref={searchBoxRef}\n          className={\"search-box\"}\n          type=\"text\"\n          name=\"default name\"\n          placeholder={\"chr6:151690496-152103274\"}\n          onKeyDown={(e) => {\n            switch (e.key) {\n              case \"ArrowUp\":\n                break;\n              case \"ArrowDown\":\n                break;\n              case \"Enter\":\n                setNaviKeyword(e.target.value);\n                // setGeneSuggestions([]);\n                // if(searchKeyword.includes('chr')) {\n                //     hmRef.current.api.zoomTo(searchKeyword);\n                // } else {\n                //     hmRef.current.api.zoomToGene(searchKeyword);\n                // }\n                break;\n              case \"Esc\":\n              case \"Escape\":\n                break;\n            }\n          }}\n        />\n        <h5>Chromosomes</h5>\n        {[...Array.from(Array(22).keys()).map((d) => d + 1), \"X\", \"Y\"].map(\n          (k) => (\n            <span\n              key={k}\n              className=\"chr-button\"\n              onClick={() => onZoomChr(`chr${k}`)}\n            >{`chr${k}`}</span>\n          )\n        )}\n        {/* <h5>Genes</h5>\n        <div className=\"gene-button\" onClick={() => onZoom(\"TP53\", \"chr17\")}>\n          TP53\n        </div>\n        <div className=\"gene-button\" onClick={() => onZoom(\"TNF\", \"chr6\")}>\n          TNF\n        </div>\n        <div className=\"gene-button\" onClick={() => onZoom(\"MYC\", \"chr8\")}>\n          MYC\n        </div>\n        <div className=\"gene-button\">...</div> */}\n        <h5>\n          {\"Putative Targets \"}\n          <a\n            className=\"sub-info\"\n            href={`http://dc2.cistrome.org/api/putative_target_ng?gene=&id=${searchKeyword}`}\n          >\n            Raw Data\n          </a>\n        </h5>\n        {putativeTargets\n          ?.filter((t) => t.symbol === t.symbol.toUpperCase() || true)\n          .slice(0, 10)\n          ?.map((t) => {\n            // console.log(t);\n            // {coordinate: \"chr13:40931923-41061385\", symbol: \"ELF1\", score: \"3.131\", visual_coordinate: \"chr13:40831923-41161385\"}\n            return (\n              <div\n                className=\"gene-button\"\n                onClick={() => onZoomPos(t.visual_coordinate)}\n                key={t.symbol}\n              >\n                {t.symbol}\n              </div>\n            );\n          })}\n        <h5>Theme</h5>\n        <div\n          className=\"gene-button\"\n          onClick={() => setTheme('light')}\n        >\n          Light\n        </div>\n        <div\n          className=\"gene-button\"\n          onClick={() => setTheme('dark')}\n        >\n          Dark\n        </div>\n        <h5>Export</h5>\n        <div\n          className=\"gene-button\"\n          onClick={() => onExport(true)}\n        >\n          PDF\n        </div>\n        <div\n          className=\"gene-button\"\n          onClick={() => onExport(false)}\n        >\n          PNG\n        </div>\n      </div>\n      <div className={`metadata-table ${theme}`}>\n        <h5>Inspector</h5>\n        <table>\n          <tr>\n            <td>GEO or ENCODE</td>\n            <td>{metadata?.treats?.[0]?.unique_id}</td>\n          </tr>\n          <tr>\n            <td>Cistrome ID</td>\n            <td>{metadata?.id}</td>\n          </tr>\n          <tr>\n            <td>Species</td>\n            <td>{metadata?.treats?.[0]?.species__name}</td>\n          </tr>\n          <tr>\n            <td>Cell Line</td>\n            <td>{metadata?.treats?.[0]?.cell_line__name}</td>\n          </tr>\n          <tr>\n            <td>Cell Type</td>\n            <td>{metadata?.treats?.[0]?.cell_type__name}</td>\n          </tr>\n          <tr>\n            <td>Tissue</td>\n            <td>{metadata?.treats?.[0]?.tissue_type__name}</td>\n          </tr>\n          <tr>\n            <td>Disease</td>\n            <td>{metadata?.treats?.[0]?.disease_state__name}</td>\n          </tr>\n          <tr>\n            <td>Factor</td>\n            <td>{metadata?.treats?.[0]?.factor__name}</td>\n          </tr>\n          <tr>\n            <td>Paper</td>\n            <td>\n              <a\n                href={metadata?.treats?.[0]?.link}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {metadata?.treats?.[0]?.paper__reference}\n              </a>\n            </td>\n          </tr>\n          <tr>\n            <td>Raw Data</td>\n            <td>\n              <a\n                href={`http://dc2.cistrome.org/api/inspector?id=${metadata?.id}`}\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n              >\n                {\"JSON\"}\n              </a>\n            </td>\n          </tr>\n        </table>\n        <h5>Expernal Links</h5>\n        <div\n          className=\"gene-button\"\n          onClick={() =>\n            window.open(\n              `http://dc2.cistrome.org/api/batchview/h/${searchKeyword\n                .split(\",\")\n                .join(\"_\")}/w/`,\n              \"_blank\"\n            )\n          }\n        >\n          Wash U Browser\n        </div>\n        <div\n          className=\"gene-button\"\n          onClick={() =>\n            window.open(\n              `http://dc2.cistrome.org/api/batchview/h/${searchKeyword\n                .split(\",\")\n                .join(\"_\")}/u/`,\n              \"_blank\"\n            )\n          }\n        >\n          UCSC Browser\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter, Route } from 'react-router-dom';\nimport App from './App';\nimport './index.css';\n\nReactDOM.render(\n  <BrowserRouter>\n    <Route component={App} />\n  </BrowserRouter>,\n  document.getElementById('root')\n);"],"sourceRoot":""}